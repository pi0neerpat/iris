datasource DS {
  // optionally set multiple providers
  // example: provider = ["sqlite", "postgresql"]
  provider = ["sqlite", "postgresql"]
  url = "***"
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

model AuthDetail {
  id        String   @id @default(uuid())
  nonce     String
  timestamp DateTime @default(now())
}

model Hero {
  address String @id
  authDetail AuthDetail
  transactions Transaction[] @relation(name: "heroTransactions")
  quests Quest[]
  merchantAccount Merchant?
  // activeQuest Quest @relation(name: "heroActiveQuest")
}

model Trigger {
  id String @id @default(uuid())
  quest Quest? @relation(name: "questTrigger")
}

model Quest {
  id String @id @default(uuid())
  merchant Merchant @relation(name: "merchantQuests")
  transactions Transaction[] @relation(name: "questTransactions")
  trigger Trigger @relation(name: "questTrigger")
  heroes Hero[] // Implicit m-n relationships don't require @relation
  heroesActive Hero[] @relation(name: "heroActiveQuest")
  contractAddress String
  methodName String
  purchaseToken Token? @relation(name: "questPurchaseToken")
  purchaseBalance String?
  domain String
  name String
}

model Token {
  id        String   @id @default(uuid())
  chainId String
  contractAddress String
  quests Quest[] @relation(name: "questPurchaseToken")
  website String?
  iconUrl String?
}

model Merchant {
  id    String  @id @default(uuid())
  owner Hero
  quests Quest[] @relation(name: "merchantQuests")
}

model Transaction {
  id String @id
  timestamp DateTime
  blockNumber String
  status String
  quest Quest @relation(name: "questTransactions")
  hero Hero @relation(name: "heroTransactions")
}
