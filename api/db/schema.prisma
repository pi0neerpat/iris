datasource DS {
  // optionally set multiple providers
  // example: provider = ["sqlite", "postgresql"]
  provider = ["sqlite", "postgresql"]
  url      = env("DATABASE_URL" )
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

model AuthDetail {
  id        String   @id @default(uuid())
  nonce     String
  timestamp DateTime @default(now())
}

model Hero {
  id    String  @id @default(uuid())
  address String
  authDetail AuthDetail
  transactions Transaction[] @relation(name: "heroTransactions")
  quests Quest[]
}

model Trigger {
  id String @id @default(uuid())
  quest Quest?
}

model Quest {
  id String @id @default(uuid())
  merchant Merchant @relation(name: "merchantQuests")
  transactions Transaction[] @relation(name: "questTransactions")
  trigger Trigger
  heroes Hero[] // Implicit m-n relationships don't require @relation
  contractAddress String
  methodName String
  token Token
}

model Token {
  id        String   @id @default(uuid())
  chainId String
  contractAddress String
  type String // erc721 or erc20
  tokenId Int? // only for erc721
  uri String? // only for erc721
  website String?
  iconUrl String?
}

model Merchant {
  id    String  @id @default(uuid())
  quests Quest[] @relation(name: "merchantQuests")
  address String
  authDetail AuthDetail

}

model Transaction {
  id String @id
  timestamp DateTime
  blockNumber String
  status String
  quest Quest @relation(name: "questTransactions")
  hero Hero @relation(name: "heroTransactions")
}
